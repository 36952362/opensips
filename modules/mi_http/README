mi_http Module

Ovidiu Sas

   <osas@voipembedded.com>

Edited by

Ovidiu Sas

   Copyright Â© 2011 VoIP Embedded, Inc.
   Revision History
   Revision $Rev: 8512 $ $Date: 2011-10-24 18:10:36 -0400 (Mon, 24
                         Oct 2011) $
     __________________________________________________________

   Table of Contents

   1. Admin Guide

        1.1. Overview
        1.2. To-do
        1.3. Dependencies

              1.3.1. OpenSIPS Modules
              1.3.2. External Libraries or Applications

        1.4. Exported Parameters

              1.4.1. ip(string)
              1.4.2. port(integer)
              1.4.3. mi_http_root(string)
              1.4.4. buf_size (integer)

        1.5. Exported Functions
        1.6. Known issues

   List of Examples

   1.1. Set ip parameter
   1.2. Set port parameter
   1.3. Set mi_http_root parameter
   1.4. Set buf_size parameter

Chapter 1. Admin Guide

1.1. Overview

   This module provides an HTTP transport layer implementation for
   OpenSIPS's Management Interface.

   Implementation of mi_http module's http server is based on
   libmicrohttpd library.

1.2. To-do

   Features to be added in the future:
     * possibility to authenticate connections.

1.3. Dependencies

1.3.1. OpenSIPS Modules

   The following modules must be loaded before this module:
     * No dependencies on other OpenSIPS modules.

1.3.2. External Libraries or Applications

   The following libraries or applications must be installed
   before running OpenSIPS with this module loaded:
     * libmicrohttpd.

1.4. Exported Parameters

1.4.1. ip(string)

   The IP address used by the HTTP server to listen for incoming
   requests.

   The default value is an empty string. If no IP address is set,
   then the http server will bind to all available IPs.

   Example 1.1. Set ip parameter
...
modparam("mi_http", "ip", "127.0.0.1")
...

1.4.2. port(integer)

   The port number used by the HTTP server to listen for incoming
   requests.

   The default value is 8888. Ports lower than 1024 are not
   accepted.

   Example 1.2. Set port parameter
...
modparam("mi_http", "port", 8000)
...

1.4.3. mi_http_root(string)

   It specifies the root path for mi http requests. The link to
   the mi web interface must be constructed using the following
   patern: http://[opensips_IP]:[opensips_mi_port]/[mi_http_root]

   The default value is "mi".

   Example 1.3. Set mi_http_root parameter
...
modparam("mi_http", "mi_http_root", "opensips_mi")
...

1.4.4. buf_size (integer)

   It specifies the maximum length of the buffer used to write in
   the MI tree node information in order to build the html
   response.

   If the size of the buffer is set to zero, it will be
   automatically set to a quarter of the size of the pkg memory.

   The default value is 0.

   Example 1.4. Set buf_size parameter
...
modparam("mi_http", "buf_size", 524288)
...

1.5. Exported Functions

   No function exported to be used from configuration file.

1.6. Known issues

   Due to the fact that OpenSIPS is a multiprocess application,
   the microhttpd library is used in "external select" mode. This
   ensures that the library is not running in multithread mode and
   the library is entirely controled by OpenSIPS. Due to this
   particular mode of operations, for now, the entire http
   response is built in a pre-allocated buffer (see buf_size
   parameter).

   Commands with large responses (like ul_dump) will fail if the
   configured size of the buffer is to small (or if there isn't
   enough pkg memory configured).

   Future realeases of this module will address this issue.
